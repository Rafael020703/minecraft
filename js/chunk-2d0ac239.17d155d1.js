(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ac239"],{"17eb":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-row",[a("v-col",[a("v-card",[a("v-card-title",[a("span",{domProps:{textContent:t._s(t.$t(t.create?"templates.New":"templates.Edit"))}}),a("div",{staticClass:"flex-grow-1"}),a("v-btn-toggle",{attrs:{borderless:"",dense:"",mandatory:""},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}},[a("v-btn",{attrs:{disabled:t.loading,value:"editor"},domProps:{textContent:t._s(t.$t("templates.Editor"))}}),a("v-btn",{attrs:{disabled:t.loading,value:"json"},domProps:{textContent:t._s(t.$t("templates.Json"))}})],1)],1),a("v-card-text",[a("v-row",[a("v-col",[a("ui-input",{attrs:{label:t.$t("common.Name"),disabled:!t.create},model:{value:t.template.name,callback:function(e){t.$set(t.template,"name",e)},expression:"template.name"}})],1)],1),"editor"===t.mode?a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("ui-input",{attrs:{label:t.$t("templates.Display")},model:{value:t.template.display,callback:function(e){t.$set(t.template,"display",e)},expression:"template.display"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("ui-input",{attrs:{label:t.$t("templates.Type")},model:{value:t.template.type,callback:function(e){t.$set(t.template,"type",e)},expression:"template.type"}})],1)],1):t._e(),t.loading?a("v-row",[a("v-col",{attrs:{offset:"5",cols:"2"}},[a("v-progress-circular",{staticClass:"mr-2",attrs:{indeterminate:""}}),a("strong",{domProps:{textContent:t._s(t.$t("common.Loading"))}})],1)],1):t._e()],1)],1)],1)],1),t.loading?t._e():a("div",["editor"===t.mode?a("template-editor",{model:{value:t.template,callback:function(e){t.template=e},expression:"template"}}):a("v-row",[a("v-col",[a("ace",{ref:"editor",attrs:{"editor-id":"edit"+t.template.name,height:"50vh",lang:"json"},model:{value:t.templateJson,callback:function(e){t.templateJson=e},expression:"templateJson"}})],1)],1),a("v-row",[a("v-col",[a("v-btn",{attrs:{color:"success",large:"",block:"",disabled:!t.template.name||""===t.template.name.trim()},domProps:{textContent:t._s(t.$t("common.Save"))},on:{click:t.save}})],1)],1),a("v-row",[a("v-col",[t.create?t._e():a("v-btn",{attrs:{color:"error",block:""},domProps:{textContent:t._s(t.$t("common.Delete"))},on:{click:function(e){return t.remove()}}})],1)],1)],1),a("ui-overlay",{attrs:{card:""},model:{value:t.offerV1Convert,callback:function(e){t.offerV1Convert=e},expression:"offerV1Convert"}},[a("v-row",{staticClass:"mb-8"},[a("v-col",{attrs:{cols:"12"}},[a("h2",{domProps:{textContent:t._s(t.$t("templates.OfferV1Convert"))}})])],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-btn",{attrs:{block:"",color:"error"},domProps:{textContent:t._s(t.$t("common.Cancel"))},on:{click:function(e){t.offerV1Convert=!1}}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-btn",{attrs:{block:""},domProps:{textContent:t._s(t.$t("common.Ignore"))},on:{click:function(e){t.offerV1Convert=!1,t.skipNextV1Check=!0}}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-btn",{attrs:{block:"",color:"success"},domProps:{textContent:t._s(t.$t("templates.Convert"))},on:{click:function(e){return t.convertV1()}}})],1)],1)],1)],1)},o=[],r={data(){return{loading:!1,create:void 0===this.$route.params.id,mode:"editor",templateJson:"",template:{name:"",type:"",display:"",command:"",stop:{},vars:[],install:[],pre:[],post:[],envVars:{},defaultEnv:{},supportedEnvs:[]},offerV1Convert:!1,skipNextV1Check:!1}},watch:{async mode(t){if("editor"===t){if(this.catchV1())return;this.template=this.$api.templateFromApiJson(this.templateJson)}else this.templateJson=this.$api.templateToApiJson(this.template),this.$refs.editor&&this.$refs.editor.ready&&this.$refs.editor.setValue(this.templateJson)}},mounted(){this.create||this.loadData()},methods:{async loadData(){this.loading=!0,this.template=await this.$api.getTemplate(this.$route.params.id),this.loading=!1},async remove(){this.create||(await this.$api.deleteTemplate(this.template.name),this.$toast.success(this.$t("templates.Deleted")),this.$router.push({name:"Templates"}))},async save(){if(this.template.name&&""!==this.template.name.trim()){if("json"===this.mode){if(this.catchV1())return;this.template=this.$api.templateFromApiJson(this.templateJson)}await this.$api.saveTemplate(this.template.name,this.template),this.$toast.success(this.$t("templates.SaveSuccess")),this.create&&this.$router.push({name:"Template",params:{id:this.name}})}},catchV1(){const t=this.skipNextV1Check;return this.skipNextV1Check=!1,"[object Object]"===Object.prototype.toString.call((JSON.parse(this.templateJson)||{}).pufferd)&&!t&&(this.offerV1Convert=!0,!0)},convertV1(){const t=JSON.parse(this.templateJson).pufferd;t.install=t.install.commands,t.run.command=t.run.program+" "+t.run.arguments.join(" "),delete t.run.program,delete t.run.arguments,t.supportedEnvironments=[t.environment],t.name=t.display.toLowerCase().replace(/ /g,"-").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-");while("-"===t.name.substring(0,1))t.name=t.name.substring(1);while("-"===t.name.substring(t.name.length-1))t.name=t.name.substring(0,t.name.length-1);this.templateJson=JSON.stringify(t,void 0,2).replace(/\$\{rootdir}/g,"${rootDir}"),this.$refs.editor&&this.$refs.editor.ready&&this.$refs.editor.setValue(this.templateJson),this.template=this.$api.templateFromApiJson(this.templateJson),this.offerV1Convert=!1}}},n=r,l=a("2877"),i=a("6544"),m=a.n(i),c=a("8336"),p=a("a609"),d=a("b0af"),h=a("99d9"),v=a("62ad"),u=a("490a"),f=a("0fd9"),b=Object(l["a"])(n,s,o,!1,null,null,null);e["default"]=b.exports;m()(b,{VBtn:c["a"],VBtnToggle:p["a"],VCard:d["a"],VCardText:h["c"],VCardTitle:h["d"],VCol:v["a"],VProgressCircular:u["a"],VRow:f["a"]})}}]);
//# sourceMappingURL=chunk-2d0ac239.17d155d1.js.map